---
# Molecule-specific vps group vars mirroring production defaults without secrets.
docker_edition: "ce"
docker_packages:
  - "docker-{{ docker_edition }}"
  - "docker-{{ docker_edition }}-cli"
  - containerd.io
  - docker-buildx-plugin
docker_packages_state: present
docker_install_compose_plugin: true
docker_compose_package: docker-compose-plugin
docker_compose_package_state: present
docker_users:
  - molecule
docker_daemon_options:
  storage-driver: vfs
  log-opts:
    max-size: "100m"
firewall_allowed_tcp_ports:
  - "{{ security_ssh_port | default(22) }}"
firewall_state: started
firewall_enabled_at_boot: true
security_ssh_password_authentication: "no"
security_ssh_permit_root_login: "no"
security_autoupdate_enabled: true
security_ssh_allowed_users:
  - "{{ ansible_user }}"
security_fail2ban_enabled: true
security_fail2ban_custom_configuration_template: "jail.local.j2"
security_autoupdate_blacklist: []
security_autoupdate_additional_origins: []
security_autoupdate_reboot: "false"
security_autoupdate_reboot_time: "03:00"
security_autoupdate_mail_to: ""
security_autoupdate_mail_on_error: true
docker_shared_network_name: proxy_net
docker_shared_network_subnet: "10.203.57.0/24"
docker_shared_network_gateway: "10.203.57.1"
docker_shared_network_ipam_config:
  - subnet: "{{ docker_shared_network_subnet }}"
    gateway: "{{ docker_shared_network_gateway }}"
cloudflared_data_directory: /opt/cloudflared
cloudflared_image_tag: "2025.11.1"
cloudflared_tunnel_domain_name: "{{ domain_name }}"
cloudflared_whoami_enabled: true
cloudflared_verify_whoami: "{{ lookup('env', 'MOLECULE_CLOUDFLARE_VERIFY') | default('true', true) | bool }}"
cloudflared_container_name: cloudflared
cloudflared_whoami_container_name: cloudflared-whoami
cloudflared_whoami_service_host: "{{ cloudflared_whoami_container_name }}"
cloudflared_whoami_service_port: 80
cloudflared_ingress_rules:
  - hostname: "whoami.{{ cloudflared_tunnel_domain_name }}"
    service: "http://{{ cloudflared_whoami_service_host }}:{{ cloudflared_whoami_service_port }}"
  - service: http_status:404
